@echo off

set IndexHome=
set IndexPro=
set IndexProN=
set IndexEnterpriseS=
FOR /L %%c IN (1,1,!images!) DO (
	for /f "tokens=3 delims=: " %%i in ('%wimlib% info %ISOFOLDER%\sources\install.wim %%c ^| findstr /b "Edition"') do (
		if /i [%%i]==[Core] set IndexHome=%%c
		if /i [%%i]==[Professional] set IndexPro=%%c
		if /i [%%i]==[ProfessionalN] set IndexProN=%%c
		if /i [%%i]==[EnterpriseS] set IndexEnterpriseS=%%c
	)
)
for %%# in (CoreSingleLanguage,CloudEdition,CloudEditionN,ProfessionalEducation,ProfessionalEducationN,ProfessionalWorkstation,ProfessionalWorkstationN,ProfessionalCountrySpecific,ProfessionalSingleLanguage,Education,EducationN,Enterprise,EnterpriseN,ServerRdsh,IoTEnterprise,IoTEnterpriseK,IoTEnterpriseS,IoTEnterpriseSK) do (call :%%#)
exit /b

:CloudEdition
if /i %build% lss 21352 exit /b
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=CloudEdition"
set "ProductId=00475-80000-00000-AA869"
set "OSProductContentId=cc260727-8d42-5c4c-3c2f-f093008dcd9a"
set "OSProductPfn=Microsoft.Windows.203.X22-53847_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303437352D38303030302D30303030302D414138363900961200005B436F5D5832322D3533383437000000961200000000E02F4E1CFB11241C090000000000244B8960EDDAEBFE0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FC7B576B"
set "DigitalProductId4=F804000004000000350035003000340031002D00300034003700350038002D003000300030002D003000300030003000300030002D00300030002D0031003000340039002D00320031003300360034002E0030003000300030002D003100310038003200300032003100000000000000000000000000000000000000000000000000000000000000390032006600620038003700320036002D0039003200610038002D0034006600660063002D0039003400630065002D0066003800320065003000370034003400340036003500330000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000043006C006F0075006400450064006900740069006F006E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000961200000000E02F4E1CFB11241C0900636972E5F0D63C608BA93E4720664C3858B991E1CC7A277780E018E825B3AE1FEDDE230572E0788B9394C8E807E23B889FA2791E24ED07D8CDDE49BE1791E7895B0043006F005D005800320032002D0035003300380034003700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=0"
set "DumpLv=1"
set "desc=Cloud"
if /i %build% GEQ 21990 set "desc=SE"
call :WIM
exit /b

:CloudEditionN
if /i %build% lss 21352 exit /b
if not defined IndexProN exit /b
set "source=%IndexProN%"
set "EditionID=CloudEditionN"
set "ProductId=00476-20000-00000-AA883"
set "OSProductContentId=c7cfb460-bc9b-b32a-69b3-acf52bd6fa48"
set "OSProductPfn=Microsoft.Windows.202.X22-53884_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303437362D32303030302D30303030302D4141383833009A1200005B436F5D5832322D35333838340000009A1200000000083F35E14BD1E61C090000000000ED618960AB1BF51E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000CDB0714D"
set "DigitalProductId4=F804000004000000350035003000340031002D00300034003700360032002D003000300030002D003000300030003000300030002D00300030002D0031003000340039002D00320031003300360034002E0030003000300030002D003100310038003200300032003100000000000000000000000000000000000000000000000000000000000000640034006200640063003600370038002D0030006100340062002D0034006100330032002D0061003500620033002D0061006100610032003400630033006200300066003200340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000043006C006F0075006400450064006900740069006F006E004E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009A1200000000083F35E14BD1E61C0900FFC38A76E892BD57EADFADE6E936A55CE150993173EE18B032CE8E375692B16E441C1C095DC8549EEC8081D13845DD718761B8DE31C4328F92092FFFD1DD922F5B0043006F005D005800320032002D0035003300380038003400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=0"
set "DumpLv=1"
set "desc=Cloud N"
if /i %build% GEQ 21990 set "desc=SE N"
call :WIM
exit /b

:IoTEnterprise
if /i %build% lss 18277 exit /b
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=IoTEnterprise"
set "ProductId=00436-20000-00000-AAOEM"
set "OSProductContentId=4b1412af-12ad-0bbd-177e-6f7579c8600f"
set "OSProductPfn=Microsoft.Windows.188.X21-99378_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303433362D32303030302D30303030302D41414F454D000A1100005B313948315D5832312D3939333738000A1100000000C8BFC44ABE281573090000000000BA3FC65C79FBCEC902000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004E6597C1"
set "DigitalProductId4=F804000004000000350035003000340031002D00300034003300360032002D003000300030002D003000300030003000300030002D00300032002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000380061006200390062006400640031002D0031006600360037002D0034003900390037002D0038003200640039002D0038003800370038003500320030003800330037006400390000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000049006F00540045006E0074006500720070007200690073006500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A1100000000C8BFC44ABE2815730900C2586D4B3D14127A7AA589B597436B2B668BB57F03BBF64B34DADF82166ED03DAE567D1A43D2A5F01CBEFFA92C8D86415273F040C17EFE9C1A53F6D49DB0A54B5B0031003900480031005D005800320031002D003900390033003700380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004F0045004D003A0044004D0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004F0045004D000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=IoT Enterprise"
call :WIM
exit /b

:IoTEnterpriseK
if /i %build% lss 25982 exit /b
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=IoTEnterpriseK"
set "ProductId=00504-70000-00000-AAOEM"
set "OSProductContentId=4727cca0-ffa3-f252-8c48-06afc5b3aa27"
set "OSProductPfn=Microsoft.Windows.206.X23-62084_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303530342D37303030302D30303030302D41414F454D00B71300005B47655D5832332D3632303834000000B713000000008C6F923E55B4C5A50900000000005D36426576D7C57602000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008AB10062"
set "DigitalProductId4=F804000004000000350035003000340031002D00300035003000340037002D003000300030002D003000300030003000300030002D00300032002D0031003000320035002D0039003200300030002E0030003000300030002D0033003000350032003000320033000000000000000000000000000000000000000000000000000000000000000000380030003000380033006500610065002D0037003000330031002D0034003300390034002D0039006500380038002D0034003900300031003900370033006400350036006600650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000049006F00540045006E00740065007200700072006900730065004B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B713000000008C6F923E55B4C5A50900B8ED6E6215B2C97A38AD9B65AC2374B18A31AAC91A6DAEF73373005B60466AB177DB59238C1DF24C2CF0902958316F304787D4A0928BE2C56F269A9D580C52355B00470065005D005800320033002D00360032003000380034000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004F0045004D003A0044004D0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004F0045004D000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=IoT Enterprise Subscription"
call :WIM
exit /b

:ServerRdsh
if not defined IndexPro exit /b
set "source=%IndexPro%"
if %build%==17134 call :ServerRdsh1803 && exit /b
set "EditionID=ServerRdsh"
set "ProductId=00432-70000-00001-AA701"
set "OSProductContentId=8e20e60b-0826-3084-51fe-cda9e1b184cd"
set "OSProductPfn=Microsoft.Windows.175.X21-83765_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303433322D37303030302D30303030312D414137303100E71000005B5253355D5832312D38333736350000E710100000000019E6ABC946E0F0090000000000A23EC65C05F0E66F0300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000651DE578"
set "DigitalProductId4=F804000004000000350035003000340031002D00300034003300320037002D003000300030002D003000300030003000300031002D00300033002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000650063003800360038006500360035002D0066006100640066002D0034003700350039002D0062003200330065002D00390033006600650033003700660032006300630032003900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000530065007200760065007200520064007300680000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E710100000000019E6ABC946E0F009002B11469E49D838FE3D68708FF122CB51C5BB3CB181B914B08DE8BFDDE9D3B495B852E47C048CEF48B76AA54F7352659895F9AA7B24F08092E3CA900D5B3DE7A15B005200530035005D005800320031002D00380033003700360035000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065003A00470056004C004B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
if [!build!]==[17763] (
	set "desc=Enterprise for Remote Sessions"
) else (
	set "desc=Enterprise for Virtual Desktops"
)
if /i %build% GEQ 21990 set "desc=Enterprise multi-session"
call :WIM
exit /b

:ServerRdsh1803
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=ServerRdsh"
set "ProductId=00389-20000-00000-AA832"
set "OSProductContentId=d509887c-3f21-a346-357e-30ac5dfc6996"
set "OSProductPfn=Microsoft.Windows.175.X21-41295_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303338392D32303030302D30303030302D414138333200340F00005B5253335D5832312D34313239350000340F0000000040D1788B99C1A53C08000000000091E42E5DF86FC72C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000097EF330A"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003800390032002D003000300030002D003000300030003000300030002D00300030002D0031003000340039002D0039003200300030002E0030003000300030002D0031003900380032003000310039000000000000000000000000000000000000000000000000000000000000000000640066003900360030003200330062002D0064006300640039002D0034006200650032002D0061006600610030002D00630036006300380037003100310035003900650062006500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000530065007200760065007200520064007300680000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000340F0000000040D1788B99C1A53C0800C592C079582A8941305DB888A49FB754FBC2932CA686B82CA12E01CEC8F5C90DE433F0A793F6172BCAB66238B5E2E0137D1CF53A84190C96AE449EBB7B95E9AF5B005200530033005D005800320031002D003400310032003900350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=Enterprise for Remote Sessions"
call :WIM
exit /b

:IoTEnterpriseS
if not defined IndexEnterpriseS exit /b
set "source=%IndexEnterpriseS%"
set "EditionID=IoTEnterpriseS"
set "ProductId=00436-50000-00000-AAOEM"
set "OSProductContentId=b5b7cdfc-42ca-f3c8-3dbf-34cdfaba0d97"
set "OSProductPfn=Microsoft.Windows.191.X21-99682_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303433362D35303030302D30303030302D41414F454D000D1100005B56625D5832312D39393638320000000D1100000000B080D3AA377F8023090000000000D7AC5D61E0A3D2EA02000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007E177681"
set "DigitalProductId4=F804000004000000350035003000340031002D00300034003300360035002D003000300030002D003000300030003000300030002D00300032002D0031003000330033002D00310037003700360033002E0030003000300030002D003200370039003200300032003100000000000000000000000000000000000000000000000000000000000000650064003600350035003000310036002D0061003900650038002D0034003400330034002D0039003500640039002D0034003300340035003300350032006300320035003500320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000049006F00540045006E0074006500720070007200690073006500530000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D1100000000B080D3AA377F80230900FAF2FA248A07B6F910792358C8BCD16DE43435B40BF4B6BAE2B42F1CE6A30E8A70E3E1DACD49B499FDACC0D9CAA4610C1C1781AFB569A78D63BE647D964CAB855B00560062005D005800320031002D00390039003600380032000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004F0045004D003A004E004F004E0053004C0050000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004F0045004D000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=IoT Enterprise LTSC"
call :WIM
exit /b

:IoTEnterpriseSK
if /i %build% lss 25193 exit /b
if not defined IndexEnterpriseS exit /b
set "source=%IndexEnterpriseS%"
set "EditionID=IoTEnterpriseSK"
set "ProductId=00486-90000-00000-AAOEM"
set "OSProductContentId=43c78df7-53a1-cf2a-da31-7b8945b3044b"
set "OSProductPfn=Microsoft.Windows.205.X23-15042_8wekyb3d8bbwe"
set "DigitalProductId="
set "DigitalProductId4="
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=IoT Enterprise LTSC Subscription"
:: call :WIM
exit /b

:Enterprise
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=Enterprise"
set "ProductId=00329-00000-00003-AA163"
set "OSProductContentId=05ce649a-eed1-d14e-aa01-4045f35ca54d"
set "OSProductPfn=Microsoft.Windows.4.X19-98698_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303332392D30303030302D30303030332D414131363300DA0C00005B54485D5831392D3938363938000000DA0C30000000186367E01565BE190800000000006A3CC65C7B0355CF03000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001820E0CF"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003200390030002D003000300030002D003000300030003000300033002D00300033002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100380032003000310039000000000000000000000000000000000000000000000000000000000000000000370033003100310031003100320031002D0035003600330038002D0034003000660036002D0062006300310031002D0066003100640037006200300064003600340033003000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000045006E007400650072007000720069007300650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000DA0C30000000186367E01565BE1908002F804AB2DB805EA13D7F55FE45580AACE318F8564D3FADB7415C2F5B04D68038B0CB8213C664AB77BE2BCA373C415436BC9DCF06233D14E08772FC1D4C4137145B00540048005D005800310039002D003900380036003900380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065003A00470056004C004B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=Enterprise"
call :WIM
exit /b

:Education
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=Education"
set "ProductId=00328-10000-00001-AA343"
set "OSProductContentId=ce14a187-835c-7270-6fcb-602268e16063"
set "OSProductPfn=Microsoft.Windows.121.X19-98668_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303332382D31303030302D30303030312D414133343300D10C00005B54485D5831392D3938363638000000D10C10000000603EF693CD84A6280800000000003B3EC65CEFDEBD170300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000FBB56065"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003200380031002D003000300030002D003000300030003000300031002D00300033002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100380032003000310039000000000000000000000000000000000000000000000000000000000000000000650030006300340032003200380038002D0039003800300063002D0034003700380038002D0061003000310034002D0063003000380030006400320065003100390032003600650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000045006400750063006100740069006F006E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D10C10000000603EF693CD84A628080097DF6CB8F7B0FE32CAD1D565E037D8EF8A2DD512CE70153460A140266ECEED293F9366CBE687D3DB1F6A8C152BBF06D2CF3526E15637F4CAD048E4FECFC139EC5B00540048005D005800310039002D003900380036003600380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065003A00470056004C004B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=Education"
call :WIM
exit /b

:ProfessionalEducation
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=ProfessionalEducation"
set "ProductId=00380-00000-00001-AA261"
set "OSProductContentId=3c88328a-7c1e-aa8a-72e7-edca5665b405"
set "OSProductPfn=Microsoft.Windows.164.X21-04955_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303338302D30303030302D30303030312D414132363100D80E00005B5253315D5832312D30343935350000D80E10000000B0D59918A63DEAC7090000000000F83EC65C8D0D82E800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003A8EA582"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003800300030002D003000300030002D003000300030003000300031002D00300030002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000360032006600300063003100300030002D0039006300350033002D0034006500300032002D0062003800380036002D00610033003500320038006400640066006500370066003600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500072006F00660065007300730069006F006E0061006C0045006400750063006100740069006F006E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D80E10000000B0D59918A63DEAC7090049CE26E216D5DA7CB7BCE6C212337CFD8DFFB4DF3542F3082038118C22F8F62AEB533B180E8C2EB103A53ADA9E058D80FE788F03A557C608FA26AF208C838F0B5B005200530031005D005800320031002D003000340039003500350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=1"
set "DumpLv=1"
set "desc=Pro Education"
call :WIM
exit /b

:ProfessionalCountrySpecific
if not defined IndexPro exit /b
if /i "!langiso!" neq "zh-cn" exit /b
set "source=%IndexPro%"
set "EditionID=ProfessionalCountrySpecific"
set "ProductId=99999-90020-00066-AA991"
set "OSProductContentId=3e1f71dc-b9ae-fd63-c3a2-e99682911015"
set "OSProductPfn=Microsoft.Windows.139.X99-99999_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000039393939392D39303032302D30303036362D4141393931003F420F005B54485D5839392D39393939390000003F422F4CE801FC13371A2B6DEB4F08000000000012DF925EAF8869AA0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000CF0BCBEB"
set "DigitalProductId4=F804000004000000350035003000340031002D00390039003900390039002D003000300032002D003000300030003000360036002D00300030002D0031003000340039002D00310037003700360033002E0030003000300030002D003100300033003200300032003000000000000000000000000000000000000000000000000000000000000000660037006100660037006400300039002D0034003000650034002D0034003100390063002D0061003400390062002D00650061006500330036003600360038003900650062006400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500072006F00660065007300730069006F006E0061006C0043006F0075006E00740072007900530070006500630069006600690063000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003F422F4CE801FC13371A2B6DEB4F0800B357C1A823A82330BAD99C6E65E42D1058ECFFCAD30DD54F8D05374D50D99CA63D2923DB538105E3AF0EB462CAD3EB1EFB14781768B8183EB300EF75ED91A5B85B00540048005D005800390039002D0039003900390039003900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=1"
set "DumpLv=0"
set "desc=Pro China Only"
call :WIM
exit /b

:ProfessionalSingleLanguage
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=ProfessionalSingleLanguage"
set "ProductId=99999-90020-00067-AA709"
set "OSProductContentId=f806a9f8-7645-ed31-212a-bb7527f467b3"
set "OSProductPfn=Microsoft.Windows.138.X99-99999_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000039393939392D39303032302D30303036372D4141373039003F420F005B54485D5839392D39393939390000003F423F4CE801F8B697544A0553D20800000000002A8D6A5EAD08BFE800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009271F612"
set "DigitalProductId4=F804000004000000350035003000340031002D00390039003900390039002D003000300032002D003000300030003000360037002D00300030002D0031003000340039002D00310037003700360033002E0030003000300030002D003000370032003200300032003000000000000000000000000000000000000000000000000000000000000000610034003800390033003800610061002D0036003200660061002D0034003900360036002D0039006400340034002D00390066003000340064006100330066003700320066003200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500072006F00660065007300730069006F006E0061006C00530069006E0067006C0065004C0061006E006700750061006700650000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003F423F4CE801F8B697544A0553D20800E082F3CD124BAA0818A7A4208FD74988AA8A2AAC7301E6357F7633D05EA1E3F763B876A7A348C20909168ECACFC7D5C8C69B2A34C6461895FB4430E6FF854ED65B00540048005D005800390039002D0039003900390039003900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=1"
set "DumpLv=0"
set "desc=Pro Single Language"
call :WIM
exit /b

:ProfessionalWorkstation
if not defined IndexPro exit /b
set "source=%IndexPro%"
set "EditionID=ProfessionalWorkstation"
set "ProductId=00391-70000-00000-AA825"
set "OSProductContentId=665f6f21-1692-5d08-17e4-934e0c638268"
set "OSProductPfn=Microsoft.Windows.161.X21-43626_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303339312D37303030302D30303030302D4141383235004D0F00005B5253335D5832312D343336323600004D0F00000000344DD4F276BB0150090000000000583FC65CE95A1CEA00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007DD61CA5"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003900310037002D003000300030002D003000300030003000300030002D00300030002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000650062003600640033003400360066002D0031006300360030002D0034003600340033002D0062003900360030002D00340030006500630033003100350039003600630034003500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500072006F00660065007300730069006F006E0061006C0057006F0072006B00730074006100740069006F006E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004D0F00000000344DD4F276BB01500900DCA02A65542EDA7278AEE106EB6DBB25C6E2B84961296DB9FCF4F525C29FD0B4434023AD5574B64901101BC377CDE0346F5E7F97ED597050592F15D40B2F63C85B005200530033005D005800320031002D003400330036003200360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
set "Print=0"
set "Insecure=1"
set "DumpLv=1"
set "desc=Pro for Workstations"
call :WIM
exit /b

:EnterpriseN
if not defined IndexProN exit /b
set "source=%IndexProN%"
set "EditionID=EnterpriseN"
set "ProductId=00329-90000-00000-AA065"
set "OSProductContentId=95bd2561-e54d-b969-789e-f7d12b386c67"
set "OSProductPfn=Microsoft.Windows.27.X19-98747_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303332392D39303030302D30303030302D414130363500E30C00005B54485D5831392D3938373437000000E30C0000000074483162F763DE2D090000000000B168C75CB909475F0300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000BBAF583E"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003200390039002D003000300030002D003000300030003000300030002D00300033002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000650032003700320065003300650032002D0037003300320066002D0034006300360035002D0061003800660030002D0034003800340037003400370064003000640039003400370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000045006E00740065007200700072006900730065004E000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000E30C0000000074483162F763DE2D0900013ACB6CFB7A43817B1886F4231F31CB9D9984E412F00E88D4AFC9BC29D6805A013BC42A03714918ED6F587A2424253F18375D7E42711D3553A7EF7BDAACB9B05B00540048005D005800310039002D003900380037003400370000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065003A00470056004C004B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=Enterprise N"
call :WIM
exit /b

:EducationN
if not defined IndexProN exit /b
set "source=%IndexProN%"
set "EditionID=EducationN"
set "ProductId=00328-60000-00001-AA362"
set "OSProductContentId=70f4ccac-9a50-0c5b-9b8c-4fe0d6276cf1"
set "OSProductPfn=Microsoft.Windows.122.X19-98682_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303332382D36303030302D30303030312D414133363200D60C00005B54485D5831392D3938363832000000D60C10000000FC97E3F1CCDF3C370900000000004C69C75C1AA7E14A03000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002B44EB37"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003200380036002D003000300030002D003000300030003000300031002D00300033002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000330063003100300032003300350035002D0064003000320037002D0034003200630036002D0061006400320033002D0032006500370065006600380061003000320035003800350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000045006400750063006100740069006F006E004E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D60C10000000FC97E3F1CCDF3C370900CDF1B541541FBEFA02F6D41F9D7F8F41203AAADAE64A2981E617D6F4E3439F1592B7C251D0024D513741D883801A4F2010CE63E9B65244FB1D641A4D8963A50E5B00540048005D005800310039002D003900380036003800320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065003A00470056004C004B000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056006F006C0075006D0065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=1"
set "Insecure=0"
set "DumpLv=0"
set "desc=Education N"
call :WIM
exit /b

:ProfessionalEducationN
if not defined IndexProN exit /b
set "source=%IndexProN%"
set "EditionID=ProfessionalEducationN"
set "ProductId=00380-10000-00001-AA148"
set "OSProductContentId=3dc4d427-0e39-c53a-6b2c-a801a01f902b"
set "OSProductPfn=Microsoft.Windows.165.X21-04956_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303338302D31303030302D30303030312D414131343800D90E00005B5253315D5832312D30343935360000D90E1000000040E86D4ECFECBC12090000000000826BC75C947D897B0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000359333A5"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003800300031002D003000300030002D003000300030003000300031002D00300030002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000310033006100330038003600390038002D0034006100340039002D0034006200390065002D0038006500380033002D00390038006600650035003100310031003000390035003300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500072006F00660065007300730069006F006E0061006C0045006400750063006100740069006F006E004E0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000D90E1000000040E86D4ECFECBC12090004D5AD09CB250227EA46806F10551398C0BE8348C85D5056A4D7FDDC3D059E056747155A62192E948AA6815878A1A99C2C20655DFBB248ACDBD8A73DCC9979BB5B005200530031005D005800320031002D003000340039003500360000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=1"
set "DumpLv=1"
set "desc=Pro Education N"
call :WIM
exit /b

:ProfessionalWorkstationN
if not defined IndexProN exit /b
set "source=%IndexProN%"
set "EditionID=ProfessionalWorkstationN"
set "ProductId=00392-20000-00000-AA717"
set "OSProductContentId=0ec42cc5-2b09-a734-1bb9-ff00e4a52d46"
set "OSProductPfn=Microsoft.Windows.162.X21-43644_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303339322D32303030302D30303030302D414137313700520F00005B5253335D5832312D34333634340000520F00000000D8B84CE6055D81ED080000000000CA6BC75C6DA8F63B0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000619D9E2C"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003900320032002D003000300030002D003000300030003000300030002D00300030002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000380039006500380037003500310030002D0062006100390032002D0034003500660036002D0038003300320039002D00330061006600610039003000350065003300650038003300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000500072006F00660065007300730069006F006E0061006C0057006F0072006B00730074006100740069006F006E004E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520F00000000D8B84CE6055D81ED0800088943EDD3CF7A8B08D896A5563ED4A52421E0D01861CB786C78E3CA17454B8912A965EB02684AC4AD00913D7997FA5432771B7FCD710600DE39FE61521B10F45B005200530033005D005800320031002D003400330036003400340000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=1"
set "DumpLv=1"
set "desc=Pro N for Workstations"
call :WIM
exit /b

:CoreSingleLanguage
if not defined IndexHome exit /b
set "source=%IndexHome%"
set "EditionID=CoreSingleLanguage"
set "ProductId=00327-60000-00000-AA157"
set "OSProductContentId=6fba12a6-3077-5301-cfde-f22f59f1e2a6"
set "OSProductPfn=Microsoft.Windows.100.X19-99661_8wekyb3d8bbwe"
set "DigitalProductId=A40000000300000030303332372D36303030302D30303030302D414131353700CC0C00005B54485D5831392D3939363631000000CC0C00000000A0DB36D6DC41C8CD090000000000B270C75CC5F629D50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100770A8"
set "DigitalProductId4=F804000004000000350035003000340031002D00300033003200370036002D003000300030002D003000300030003000300030002D00300030002D0031003000320035002D0039003200300030002E0030003000300030002D0031003100390032003000310039000000000000000000000000000000000000000000000000000000000000000000330061006500320063006300310034002D0061006200320064002D0034003100660034002D0039003700320066002D0035006500320030003100340032003700370031006400630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000043006F0072006500530069006E0067006C0065004C0061006E0067007500610067006500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000CC0C00000000A0DB36D6DC41C8CD09002A9E0AB03607F36AE6CA609D0A54E68E58186B61A1D6A3C0BFDD6FC40AF2168D262581306BED0061DC0DDD8912031EE633FC7BB84B09C413ACAA627B3AABC92C5B00540048005D005800310039002D0039003900360036003100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000520065007400610069006C000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
set "Print=0"
set "Insecure=1"
set "DumpLv=1"
set "desc=Home Single Language"
call :WIM
exit /b

:WIM
echo ============================================================================
echo %lang_creating_edition% - %desc%...
echo ============================================================================
echo.
set "namewin=Windows 10"
if /i %build% GEQ 21990 (
	set "namewin=Windows 11"
	if /i %EditionID%==PPIPro set "namewin=Windows 10"
)
"%wimlib%" export "%ISOFOLDER%\sources\install.wim" %source% "%ISOFOLDER%\sources\install.wim" "%namewin% %desc%" "%namewin% %desc%" 1>nul 2>nul
for /f "tokens=3 delims=: " %%i in ('%wimlib% info %ISOFOLDER%\sources\install.wim ^| findstr /c:"Image Count"') do set temp_ind=%%i
"%wimlib%" extract %ISOFOLDER%\sources\install.wim !temp_ind! \Windows\System32\config\SOFTWARE \Windows\System32\config\SYSTEM \Windows\servicing\Editions\%EditionID%Edition.xml --dest-dir=%rand%\temp --no-acls --no-attributes 1>nul 2>nul
1>nul 2>nul reg load HKLM\SOF_%rand% %rand%\temp\SOFTWARE
1>nul 2>nul reg load HKLM\SYS_%rand% %rand%\temp\SYSTEM
for %%# in (EditionID,ProductId) do (
1>nul 2>nul reg add "HKLM\SOF_%rand%\Microsoft\Windows NT\CurrentVersion" /f /v %%# /t REG_SZ /d !%%#!
1>nul 2>nul reg add "HKLM\SOF_%rand%\Microsoft\Windows NT\CurrentVersion\DefaultProductKey2" /f /v %%# /t REG_SZ /d !%%#!
)
for %%# in (DigitalProductId,DigitalProductId4) do (
1>nul 2>nul reg add "HKLM\SOF_%rand%\Microsoft\Windows NT\CurrentVersion" /f /v %%# /t REG_BINARY /d !%%#!
1>nul 2>nul reg add "HKLM\SOF_%rand%\Microsoft\Windows NT\CurrentVersion\DefaultProductKey2" /f /v %%# /t REG_BINARY /d !%%#!
)
for %%# in (OSProductContentId,OSProductPfn) do (
1>nul 2>nul reg add "HKLM\SOF_%rand%\Microsoft\Windows NT\CurrentVersion\DefaultProductKey2" /f /v %%# /t REG_SZ /d !%%#!
1>nul 2>nul reg add "HKLM\SYS_%rand%\ControlSet001\Control\ProductOptions" /f /v %%# /t REG_SZ /d !%%#!
)
1>nul 2>nul reg add "HKLM\SYS_%rand%\ControlSet001\Services\LanmanWorkstation\Parameters" /f /v AllowInsecureGuestAuth /t REG_DWORD /d !Insecure!
1>nul 2>nul reg add "HKLM\SOF_%rand%\Microsoft\Windows NT\CurrentVersion\Print" /f /v DoNotInstallCompatibleDriverFromWindowsUpdate /t REG_DWORD /d !Print!
1>nul 2>nul reg add "HKLM\SOF_%rand%\Microsoft\Windows\CurrentVersion\Setup\OOBE" /f /v SetupDisplayedProductKey /t REG_DWORD /d 1
if %build% geq 22557 (
1>nul 2>nul reg.exe add "HKLM\SOF\Microsoft\Windows\Windows Error Reporting" /f /v ChangeDumpTypeByTelemetryLevel /t REG_DWORD /d !DumpLv!
)
if /i %EditionID%==ServerRdsh (
1>nul 2>nul reg add "HKLM\SYS_%rand%\Setup\FirstBoot\PreOobe" /f /v 00 /t REG_SZ /d "cmd.exe /c WMIC /NAMESPACE:\\ROOT\CIMV2 PATH Win32_UserAccount WHERE \"SID like 'S-1-5-21-%%-500'\" SET Disabled=FALSE &exit /b 0 "
)
1>nul 2>nul reg unload HKLM\SOF_%rand%
1>nul 2>nul reg unload HKLM\SYS_%rand%
type nul>%rand%\temp\virtual.txt
>>%rand%\temp\virtual.txt echo add '%rand%^\temp^\SOFTWARE' '^\Windows^\System32^\config^\SOFTWARE'
>>%rand%\temp\virtual.txt echo add '%rand%^\temp^\SYSTEM' '^\Windows^\System32^\config^\SYSTEM'
>>%rand%\temp\virtual.txt echo add '%rand%^\temp^\%EditionID%Edition.xml' '^\Windows^\%EditionID%.xml'
"%wimlib%" update %ISOFOLDER%\sources\install.wim %temp_ind% < %rand%\temp\virtual.txt 1>nul 2>nul
rmdir /s /q %rand%\temp\
"%wimlib%" info %ISOFOLDER%\sources\install.wim %temp_ind% --image-property WINDOWS/EDITIONID=%EditionID% --image-property FLAGS=%EditionID% --image-property DISPLAYNAME="%namewin% %desc%" --image-property DISPLAYDESCRIPTION="%namewin% %desc%" --image-property FLAGS="!EditionID!"
echo.
exit /b
